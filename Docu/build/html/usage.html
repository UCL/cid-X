
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Usage &#8212; cid-X: Consistent invertible deformation-vector-fields for the XCAT phantom 0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license_link.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="license_link.html" title="License"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cid-X: Consistent invertible deformation-vector-fields for the XCAT phantom 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>Fill in the configuration file <code class="docutils literal notranslate"><span class="pre">XCAT_dvf_processing.cfg</span></code> (see here: <a class="reference internal" href="#config-file"><span class="std std-ref">The configuration file</span></a>) and call the main script with the config file as a parameter.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python XCATdvfProcessing.py XCAT_dvf_processing.cfg
</pre></div>
</div>
<p>A detailed description of how to configure the processing is given below</p>
</div>
<div class="section" id="processing-steps">
<h2>Processing steps<a class="headerlink" href="#processing-steps" title="Permalink to this headline">¶</a></h2>
<p>The processing pipeline can be divided into three separate parts, namely</p>
<ul class="simple">
<li><p><strong>pre-processing</strong> (see: <a class="reference internal" href="#pre-processing"><span class="std std-ref">Pre-processing</span></a>),</p></li>
<li><p><strong>batch DVF post-processing</strong> (see: <a class="reference internal" href="#batch-dvf-processing"><span class="std std-ref">Batch DVF post-processing</span></a>), and</p></li>
<li><p><strong>batch image warping</strong> (see: <a class="reference internal" href="#batch-warping"><span class="std std-ref">Batch warping</span></a>).</p></li>
</ul>
<p>By setting the corresponding parameters in the first section of the configuration file, the different steps are enabled or disabled. It is highly recommended to run each individual step and check the results before continuing with the next.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">PROCESSING_STEPS</span><span class="p">]</span>
<span class="n">doPreProcessing</span>       <span class="o">=</span> <span class="mi">1</span>
<span class="n">doBatchPostProcessing</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">doBatchWarping</span>        <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="section" id="pre-processing">
<span id="id1"></span><h3>Pre-processing<a class="headerlink" href="#pre-processing" title="Permalink to this headline">¶</a></h3>
<p>The most important output of the pre-processing is the <em>signed distance map</em> that defines the sliding regions in the first time point. To calculate this, first a rough segmentation using the information provided by the XCAT DVF-text file is generated. This is an incomplete segmentation (since organs are defined by surfaces), the sliding region is thereafter calculated by a level-set evolution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the level-set evolution can take some time to complete.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">PREPROCESSING</span><span class="p">]</span>
<span class="n">xcatAtnFile</span>       <span class="o">=</span> <span class="o">&lt;</span><span class="n">Complete</span><span class="o">/</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">XCAT</span><span class="o">/</span><span class="n">attenuation</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">bin</span><span class="o">&gt;</span>
<span class="n">xcatDVFFile</span>       <span class="o">=</span> <span class="o">&lt;</span><span class="n">Complete</span><span class="o">/</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">XCAT</span><span class="o">/</span><span class="n">DVF</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">txt</span><span class="o">&gt;</span>
<span class="n">outDir</span>            <span class="o">=</span> <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">results</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">pre</span><span class="o">-</span><span class="n">processing</span><span class="o">/</span><span class="n">step</span><span class="o">/</span><span class="n">will</span><span class="o">/</span><span class="n">be</span><span class="o">/</span><span class="n">written</span><span class="o">/&gt;</span>
<span class="n">outDistMapImgName</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheSignedDistanceMap</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>      <span class="c1"># will be written to [PREPROCESSING][outDir]</span>
<span class="n">outXCATAtnImgName</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheXCATAttenuationFile</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>    <span class="c1"># will be written to [PREPROCESSING][outDir]</span>
<span class="n">numVoxX</span>           <span class="o">=</span> <span class="o">&lt;</span><span class="n">imageDimensionInX</span><span class="o">&gt;</span>
<span class="n">numVoxY</span>           <span class="o">=</span> <span class="o">&lt;</span><span class="n">imageDimensionInY</span><span class="o">&gt;</span>
<span class="n">numVoxZ</span>           <span class="o">=</span> <span class="o">&lt;</span><span class="n">imageDimensionInZ</span><span class="o">&gt;</span>
<span class="n">spacingX</span>          <span class="o">=</span> <span class="o">&lt;</span><span class="n">voxelSpacingInX</span><span class="o">&gt;</span>
<span class="n">spacingY</span>          <span class="o">=</span> <span class="o">&lt;</span><span class="n">voxelSpacingInY</span><span class="o">&gt;</span>
<span class="n">spacingZ</span>          <span class="o">=</span> <span class="o">&lt;</span><span class="n">voxelSpacingInZ</span><span class="o">&gt;</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">outXCATCTImgName</span>           <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheXCATImageInHU</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>   <span class="c1"># will be written to [PREPROCESSING][outDir]</span>
<span class="n">numberOfLevelSetIterations</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">numberOfLevelSetIterations</span><span class="o">&gt;</span>          <span class="c1"># Values depend on the field of view, the image resolution etc.</span>
                                                                   <span class="c1"># we so far had good experiences with values between 5000 and 7500</span>
<span class="n">outLevelSetImgName</span>         <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheLevelSetImage</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>   <span class="c1"># will be written to [PREPROCESSING][outDir]</span>
<span class="n">saveLevelSetImage</span>          <span class="o">=</span> <span class="mi">1</span>                                     <span class="c1"># Set to 1 if you would like the level-set image to be saved, to 0 otherwise</span>
</pre></div>
</div>
</div>
<div class="section" id="batch-dvf-post-processing">
<span id="batch-dvf-processing"></span><h3>Batch DVF post-processing<a class="headerlink" href="#batch-dvf-post-processing" title="Permalink to this headline">¶</a></h3>
<p>The batch processing uses the signed distance map from the previous step to calculate the sliding-preserving inversion of the XCAT DVF. The output of this step are the forward and backward DVFs that can are used as the new ground-truth deformations.</p>
<p>One final pre-processing step is carried out for the first iteration, which calculates the spatial gradient of the signed distance map at the first simulated time point. Only the output file names need to be specified and if these files do not exist in the pre-processing output directory these will be automatically generated.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">BATCH_POSTPROCESSING</span><span class="p">]</span>
<span class="n">xcatDVFFilePattern</span>   <span class="o">=</span> <span class="o">&lt;</span><span class="n">Complete</span><span class="o">/</span><span class="n">Path</span><span class="o">/</span><span class="ow">and</span><span class="o">/</span><span class="n">pattern</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="nb">all</span><span class="o">/</span><span class="n">XCAT</span><span class="o">/</span><span class="n">DVF_files_vec_frame1</span><span class="o">*.</span><span class="n">txt</span><span class="o">&gt;</span>   <span class="c1"># Use the wildcard * to enable listing all DVF files</span>
<span class="n">outDir</span>               <span class="o">=</span> <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">results</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">batch</span><span class="o">-</span><span class="n">dvf</span><span class="o">-</span><span class="n">processing</span><span class="o">/</span><span class="n">step</span><span class="o">/</span><span class="n">will</span><span class="o">/</span><span class="n">be</span><span class="o">/</span><span class="n">written</span><span class="o">/&gt;</span>
<span class="n">tmpDir</span>               <span class="o">=</span> <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">temporary</span><span class="o">/</span><span class="n">filest</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">batch</span><span class="o">-</span><span class="n">dvf</span><span class="o">-</span><span class="n">processing</span><span class="o">/</span><span class="n">step</span><span class="o">/</span><span class="n">will</span><span class="o">/</span><span class="n">be</span><span class="o">/</span><span class="n">written</span><span class="o">/&gt;</span>
<span class="n">outDistMapDxImgName</span>  <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheSDT_gradientInX</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>    <span class="c1"># maybe something like this: distMap_dx.nii.gz</span>
<span class="n">outDistMapDyImgName</span>  <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheSDT_gradientInY</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>    <span class="c1"># maybe something like this: distMap_dy.nii.gz</span>
<span class="n">outDistMapDzImgName</span>  <span class="o">=</span> <span class="o">&lt;</span><span class="n">fileNameOfTheSDT_gradientInZ</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>    <span class="c1"># maybe something like this: distMap_dz.nii.gz</span>
<span class="n">corruptedFilesDir</span>    <span class="o">=</span> <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">potentially</span><span class="o">/</span><span class="n">corrupted</span><span class="o">/</span><span class="n">XCAT</span><span class="o">/</span><span class="n">text</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">will</span><span class="o">/</span><span class="n">be</span><span class="o">/</span><span class="n">written</span><span class="o">/&gt;</span>
<span class="n">numProcessorsDVFInv</span>  <span class="o">=</span> <span class="o">&lt;</span><span class="n">NumberOfProcessorsUsedByNiftyReg</span><span class="o">&gt;</span>       <span class="c1"># Integer value</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">niftyRegBinDir</span>       <span class="o">=</span>  <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">niftyReg</span><span class="o">/</span><span class="n">binaries</span><span class="o">/</span><span class="n">are</span><span class="o">/</span><span class="n">installed</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p>XCAT DVF text files that cannot be completely processed will be moved to the path defined in <code class="docutils literal notranslate"><span class="pre">[BATCH_POSTPROCESSING][corruptedFilesDir]</span></code>. Incomplete processing can be caused by corrupted XCAT-text files or by other errors occuring during the processing.</p>
</div>
<div class="section" id="batch-warping">
<span id="id2"></span><h3>Batch warping<a class="headerlink" href="#batch-warping" title="Permalink to this headline">¶</a></h3>
<p>In this step the deformation vector fields produced in the previous step are used to transform/warp the first time point to all other time points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">BATCH_WARPING</span><span class="p">]</span>
<span class="n">warpedOutImgBaseName</span>     <span class="o">=</span> <span class="n">imgWarpedByDVF_</span>          <span class="c1"># prefix of the transformed output images</span>
<span class="n">outDir</span>                   <span class="o">=</span> <span class="o">&lt;</span><span class="n">Path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">where</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">results</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">bath</span><span class="o">-</span><span class="n">warping</span><span class="o">/</span><span class="n">step</span><span class="o">/</span><span class="n">will</span><span class="o">/</span><span class="n">be</span><span class="o">/</span><span class="n">written</span><span class="o">/&gt;</span>
<span class="n">dvfPostFix</span>               <span class="o">=</span> <span class="n">__dvf_dvfCor_Nto1</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>  <span class="c1"># This usually does not need to be changed</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">scaleLungIntensity</span>       <span class="o">=</span> <span class="mi">1</span>            <span class="c1"># Set to 1 if you would like the lung intensity to change according to the Jacobian of the deformation</span>
<span class="n">referenceImgName</span>         <span class="o">=</span> <span class="o">&lt;</span><span class="n">Complete</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">that</span><span class="o">/</span><span class="n">you</span><span class="o">/</span><span class="n">would</span><span class="o">/</span><span class="n">like</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">warp</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span><span class="o">&gt;</span>
<span class="n">lungLowerThreshold</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">760</span>         <span class="c1"># If using HU values this should be a reasonable lower threshold for lung tissue</span>
<span class="n">lungUpperThreshold</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">730</span>         <span class="c1"># If using HU values this should be a reasonable upper threshold for lung tissue</span>
<span class="n">additionalResampleParams</span> <span class="o">=</span> <span class="o">-</span><span class="n">pad</span> <span class="o">-</span><span class="mf">1000.0</span> <span class="c1"># Set the padding value of the resampling to -1000</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">dvfPostFix</span></code> usually does not need to be changed. You should get a list of all post-processed DVF files by doing an <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">[BATCH_POSTPROCESSING][outDir]*[BATCH_WARPING][dvfPostFix]</span></code> on the command line. Replace the elements in square brackets with the parameters in the corresponding sections of your configuration file.</p>
</div>
</div>
</div>
<div class="section" id="general-notes">
<h2>General notes<a class="headerlink" href="#general-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Image files are always saved in nifti image format. To save space it is highly recommended to use the compressed <em>g-zipped</em> file format. This can be done by selecting the file extension <code class="docutils literal notranslate"><span class="pre">.nii.gz</span></code> instead of <code class="docutils literal notranslate"><span class="pre">.nii</span></code>.</p></li>
<li><p>Each processing step has its own output directory</p></li>
<li><p>Some computations in the later parts of the processing pipeline depend on previous results. Some results are thus expected in the output directories.</p></li>
<li><p>End parameters that define a path with the separator /</p></li>
<li><p>Please use the forward slash / as a path separator also on Windows systems</p></li>
</ul>
</div>
<div class="section" id="the-configuration-file">
<span id="config-file"></span><h2>The configuration file<a class="headerlink" href="#the-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>The contents of the complete configuration file is given below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Configuration file for XCAT DVF-processing</span>
<span class="c1">#</span>
<span class="c1"># Usage: This file configures the python script XCATdvfProcessing.py. The path to this configuration file needs to be </span>
<span class="c1">#        given to this script as an input parameter. </span>
<span class="c1"># </span>
<span class="c1">#  1) The DVF processing consists of three steps which can be switched on and off in the section [PROCESSING_STEPS].</span>
<span class="c1">#     Only the proecessing steps selected will be performed. The steps are described in further detail below ( 2) - 4) )</span>
<span class="c1">#  2) The pre-processing step as defined in section [PREPROCESSING]</span>
<span class="c1">#     2.1) An attenuation file generated by the XCAT simulator (.bin file format) is converted to the nifti image file </span>
<span class="c1">#          format (.nii.gz file format)</span>
<span class="c1">#     2.2) Optionally a CT-like file is generated from the attenuation file and the corresponding coefficients</span>
<span class="c1">#     2.3) A sliding segmentation is created from a DVF text file generated by the XCAT simulator</span>
<span class="c1">#     2.4) A signed distance map is generated based on 2.3)</span>
<span class="c1">#  3) The batch-processing of the XCAT-generated deformation vector fields (DVFs) [BATCH_POSTPROCESSING]</span>
<span class="c1">#     3.1) Each DVF file will be split into sliding regions according to the segmentation in 2) </span>
<span class="c1">#     3.2) An invertible DVF will be generated for each region and composed into a single DVF</span>
<span class="c1">#     Note: The gradient of the signed distance map (2.4) is required. If the defined output files do not exist</span>
<span class="c1">#           these will be generated automatically. The output directory for these gradient files is the output</span>
<span class="c1">#           directory of step 2), [PREPROCESSING].</span>
<span class="c1">#  4) Warping of the first XCAT image based on the generated DVFs</span>
<span class="c1">#     4.1) If no reference image is defined, the XCAT attenuation map of step 2.1) will be used</span>
<span class="c1">#     4.2) If a CT-like image was generated, lung intensities can be changed according to their volume change. </span>
<span class="c1">#          To do this, set [BATCH_WARPING][scaleLungIntensity = 1], define the CT-like image as the reference</span>
<span class="c1">#          image, and select reasonable lung threhold values which are used to generate a lung mask.</span>
<span class="c1">#</span>


<span class="p">[</span><span class="n">PROCESSING_STEPS</span><span class="p">]</span>
<span class="n">doPreProcessing</span>       <span class="o">=</span> <span class="mi">1</span>
<span class="n">doBatchPostProcessing</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">doBatchWarping</span>        <span class="o">=</span> <span class="mi">0</span> 


<span class="p">[</span><span class="n">PREPROCESSING</span><span class="p">]</span>
<span class="n">xcatAtnFile</span>       <span class="o">=</span> <span class="n">Q</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">ICR</span><span class="o">/</span><span class="n">XCAT2019_10</span><span class="o">/</span><span class="n">phantom</span><span class="o">/</span><span class="n">phtm_atn_1</span><span class="o">.</span><span class="n">bin</span>
<span class="n">xcatDVFFile</span>       <span class="o">=</span> <span class="n">Q</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">ICR</span><span class="o">/</span><span class="n">XCAT</span><span class="o">/</span><span class="mi">2019_10</span><span class="o">/</span><span class="n">DVF</span><span class="o">/</span><span class="n">dvf_vec_frame1_to_frame2</span><span class="o">/</span><span class="n">dvf_vec_frame1_to_frame2</span><span class="o">.</span><span class="n">txt</span>
<span class="n">outDir</span>            <span class="o">=</span> <span class="n">Q</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">ICR</span><span class="o">/</span><span class="n">XCAT2019_10</span><span class="o">/</span><span class="n">preProcessing</span><span class="o">/</span>
<span class="n">outDistMapImgName</span> <span class="o">=</span> <span class="n">distMap</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">outXCATAtnImgName</span> <span class="o">=</span> <span class="n">phtm_atn_1</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">numVoxX</span>           <span class="o">=</span> <span class="mi">256</span>
<span class="n">numVoxY</span>           <span class="o">=</span> <span class="mi">256</span>
<span class="n">numVoxZ</span>           <span class="o">=</span> <span class="mi">281</span>
<span class="n">spacingX</span>          <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">spacingY</span>          <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">spacingZ</span>          <span class="o">=</span> <span class="mf">2.0</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">outXCATCTImgName</span>           <span class="o">=</span> <span class="n">phtm_HU_1</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>  
<span class="n">numberOfLevelSetIterations</span> <span class="o">=</span> <span class="mi">7500</span>
<span class="n">outLevelSetImgName</span>         <span class="o">=</span> <span class="n">levelSetOut</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">saveLevelSetImage</span>          <span class="o">=</span> <span class="mi">1</span>


<span class="p">[</span><span class="n">BATCH_POSTPROCESSING</span><span class="p">]</span>
<span class="n">xcatDVFFilePattern</span>   <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">dvf_vec_frame1</span><span class="o">*.</span><span class="n">txt</span>
<span class="n">outDir</span>               <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">dvfNifti</span><span class="o">/</span>
<span class="n">tmpDir</span>               <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">tmpXCAT</span><span class="o">/</span>
<span class="n">outDistMapDxImgName</span>  <span class="o">=</span> <span class="n">distMap_dx</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">outDistMapDyImgName</span>  <span class="o">=</span> <span class="n">distMap_dy</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">outDistMapDzImgName</span>  <span class="o">=</span> <span class="n">distMap_dz</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">corruptedFilesDir</span>    <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">corruptedFiles</span><span class="o">/</span>
<span class="n">numProcessorsDVFInv</span>  <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">niftyRegBinDir</span>       <span class="o">=</span>  <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">development</span><span class="o">/</span><span class="n">niftyreg</span><span class="o">/</span><span class="n">cmicLab</span><span class="o">/</span><span class="n">install_release</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>


<span class="p">[</span><span class="n">BATCH_WARPING</span><span class="p">]</span>
<span class="n">warpedOutImgBaseName</span>     <span class="o">=</span> <span class="n">imgWarpedByDVF_</span>
<span class="n">outDir</span>                   <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">warpedByDVF</span><span class="o">/</span>
<span class="n">dvfPostFix</span>               <span class="o">=</span> <span class="n">__dvf_dvfCor_Nto1</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>

<span class="c1"># Optional, comment if not using</span>
<span class="n">scaleLungIntensity</span>       <span class="o">=</span> <span class="mi">1</span>
<span class="n">referenceImgName</span>         <span class="o">=</span> <span class="n">D</span><span class="p">:</span><span class="o">/</span><span class="n">debugData</span><span class="o">/</span><span class="n">xcat_intensityScaling</span><span class="o">/</span><span class="n">preProcessing</span><span class="o">/</span><span class="n">phtm_HU_1</span><span class="o">.</span><span class="n">nii</span><span class="o">.</span><span class="n">gz</span>
<span class="n">lungLowerThreshold</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">760</span>
<span class="n">lungUpperThreshold</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">730</span>
<span class="n">additionalResampleParams</span> <span class="o">=</span> <span class="o">-</span><span class="n">pad</span> <span class="o">-</span><span class="mf">1000.0</span>

</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Usage</a><ul>
<li><a class="reference internal" href="#quick-start">Quick start</a></li>
<li><a class="reference internal" href="#processing-steps">Processing steps</a><ul>
<li><a class="reference internal" href="#pre-processing">Pre-processing</a></li>
<li><a class="reference internal" href="#batch-dvf-post-processing">Batch DVF post-processing</a></li>
<li><a class="reference internal" href="#batch-warping">Batch warping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#general-notes">General notes</a></li>
<li><a class="reference internal" href="#the-configuration-file">The configuration file</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="license_link.html"
                        title="next chapter">License</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/usage.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="license_link.html" title="License"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cid-X: Consistent invertible deformation-vector-fields for the XCAT phantom 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, University College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.2.
    </div>
  </body>
</html>